---
phase: 04-polish-enhancement
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified: [
  "frontend/components/import/challenge-import-form.tsx",
  "frontend/components/import/validation-feedback.tsx",
  "frontend/components/import/import-wizard.tsx",
  "frontend/app/import/page.tsx",
  "api/import/route.js",
  "api/validation/import-handler.js",
  "frontend/components/discovery/challenge-list.tsx",
  "frontend/lib/challenge-store.js"
]
autonomous: true

must_haves:
  truths:
    - "User can access challenge import interface from main navigation"
    - "User can select and upload challenge configuration files"
    - "User receives immediate validation feedback with specific error messages and fix suggestions"
    - "Successfully validated challenges appear in discovery interface alongside built-in challenges"
    - "Imported challenges can be spawned and used exactly like built-in challenges"
  artifacts:
    - path: "frontend/app/import/page.tsx"
      provides: "Challenge import page with wizard workflow"
      contains: "Next.js page component"
    - path: "frontend/components/import/challenge-import-form.tsx"
      provides: "File upload and validation form"
      exports: ["ChallengeImportForm"]
    - path: "api/import/route.js"
      provides: "Challenge import API endpoint"
      exports: ["POST"]
    - path: "api/validation/import-handler.js"
      provides: "Import validation orchestration"
      exports: ["validateImport"]
    - path: "frontend/components/discovery/challenge-list.tsx"
      provides: "Updated discovery interface with imported challenges"
      contains: "imported challenge integration"
    - path: "frontend/lib/challenge-store.js"
      provides: "Challenge storage and retrieval system"
      exports: ["getChallenges", "addImportedChallenge"]
  key_links:
    - from: "frontend/components/import/challenge-import-form.tsx"
      to: "/api/import"
      via: "form submission and validation"
      pattern: "fetch.*api/import"
    - from: "api/import/route.js"
      to: "api/validation/validators.js"
      via: "validation system integration"
      pattern: "validators\\."
    - from: "frontend/components/import/validation-feedback.tsx"
      to: "frontend/components/enhanced/"
      via: "enhanced UI components"
      pattern: "import.*enhanced"
    - from: "api/import/route.js"
      to: "frontend/lib/challenge-store.js"
      via: "imported challenge storage"
      pattern: "addImportedChallenge"
    - from: "frontend/components/discovery/challenge-list.tsx"
      to: "frontend/lib/challenge-store.js"
      via: "unified challenge retrieval"
      pattern: "getChallenges"
---

<objective>
Create challenge import user interface with wizard workflow, file validation, and comprehensive error feedback using enhanced shadcn/ui components, ensuring imported challenges integrate seamlessly with the discovery interface.

Purpose: Enables users to import custom challenges with guided workflow and immediate validation feedback, completing the extensible challenge management system where imported challenges work exactly like built-in ones.
Output: Complete challenge import UI workflow with validation integration, user-friendly error handling, and seamless discovery interface integration.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-polish-enhancement/04-CONTEXT.md
@.planning/phases/04-polish-enhancement/04-RESEARCH.md
@.planning/phases/04-polish-enhancement/04-01-SUMMARY.md
@frontend/components/ui/
@challenges/definitions/challenges.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Challenge Import API Integration</name>
  <files>
    api/import/route.js
    api/validation/import-handler.js
  </files>
  <action>
    Create challenge import API endpoint:
    - Accept multipart/form-data for file uploads
    - Support both single JSON files and ZIP archives with Dockerfile + config.json
    - Integrate with validation system from 04-01 plan
    - Return structured validation results with specific error messages
    - Handle file size limits and format validation
    - Use Express.js/Next.js API patterns for file handling

    Create import validation handler:
    - Orchestrate file parsing, schema validation, security checks
    - Extract challenge definitions from uploaded files
    - Apply comprehensive validation pipeline from validation system
    - Map technical validation errors to user-friendly messages
    - Include fix suggestions for common validation failures
    - Return success/error state with detailed feedback
  </action>
  <verify>test -f api/import/route.js && test -f api/validation/import-handler.js</verify>
  <done>Challenge import API accepts file uploads and provides structured validation results with user-friendly error messages</done>
</task>

<task type="auto">
  <name>Task 2: Challenge Import UI Workflow</name>
  <files>
    frontend/components/import/challenge-import-form.tsx
    frontend/components/import/validation-feedback.tsx
    frontend/components/import/import-wizard.tsx
    frontend/app/import/page.tsx
  </files>
  <action>
    Create challenge import form component using enhanced UI:
    - File upload input with drag-and-drop support
    - Multi-step wizard: file selection → validation → confirmation
    - Use enhanced loading skeleton during validation
    - Integration with shadcn/ui Form, Button, Input components
    - Progress indicator showing validation status
    - Support for both JSON and ZIP file uploads

    Create validation feedback component:
    - Display validation results with clear success/error states
    - Map validation errors to user-friendly messages with fix suggestions
    - Use enhanced shadcn/ui Alert, Badge components for styling
    - Include expandable details for technical users
    - Highlight specific validation issues with context

    Create import wizard wrapper:
    - Multi-step workflow with progress indication
    - Guide users through import process
    - Handle file validation, error display, success confirmation
    - Use enhanced progress indicator component
    - Breadcrumb navigation between steps

    Create main import page:
    - Next.js page component at /import route
    - Import wizard integration with proper layout
    - Navigation integration with main app structure
    - Responsive design using Tailwind/shadcn patterns
  </action>
  <verify>find frontend/components/import -name "*.tsx" | wc -l | grep -q "3" && test -f frontend/app/import/page.tsx</verify>
  <done>Complete challenge import UI workflow with wizard, file upload, validation feedback, and user-friendly error handling using enhanced components</done>
</task>

<task type="auto">
  <name>Task 3: Discovery Interface Integration for Imported Challenges</name>
  <files>
    frontend/lib/challenge-store.js
    frontend/components/discovery/challenge-list.tsx
  </files>
  <action>
    Create unified challenge store system:
    - Implement challenge storage abstraction that handles both built-in and imported challenges
    - Create getChallenges() function that returns combined challenge list from both sources
    - Add addImportedChallenge() function to persist imported challenges
    - Store imported challenges in localStorage or IndexedDB for persistence
    - Include metadata to distinguish imported vs built-in challenges
    - Ensure imported challenges maintain same data structure as built-in ones

    Update discovery interface to display imported challenges:
    - Modify challenge-list.tsx to use unified challenge store
    - Display imported challenges alongside built-in ones with same styling
    - Add visual indicator (badge/icon) to distinguish imported challenges
    - Ensure imported challenges support all same operations (spawn, view details, etc.)
    - Maintain consistent enhanced UI styling for all challenge cards
    - Include proper error handling if imported challenge data is corrupted

    Reference existing code: Use challenge structure from challenges/definitions/challenges.json as template
    Gap reason: DISC-06 requires imported challenges integrate with discovery interface
  </action>
  <verify>test -f frontend/lib/challenge-store.js && grep -q "getChallenges\|addImportedChallenge" frontend/lib/challenge-store.js && grep -q "challenge-store" frontend/components/discovery/challenge-list.tsx</verify>
  <done>Discovery interface displays imported challenges alongside built-in ones with consistent functionality and visual indicators</done>
</task>

</tasks>

<verification>
Access import interface at http://localhost:3000/import
Test file upload with valid challenge JSON
Test validation error handling with invalid challenge file
Verify imported challenges appear in discovery interface at http://localhost:3000
</verification>

<success_criteria>
- User can access challenge import interface from main navigation
- User can upload challenge files with immediate validation feedback
- Validation errors display helpful messages with specific fix suggestions
- Successfully imported challenges integrate with existing challenge system
- Imported challenges appear in discovery interface with same functionality as built-in challenges
</success_criteria>

<output>
After completion, create `.planning/phases/04-polish-enhancement/04-02-SUMMARY.md`
</output>