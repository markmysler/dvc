---
phase: 01-foundation-security
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [package.json, docker-compose.yml, scripts/setup.sh, README.md, .gitignore]
autonomous: true

must_haves:
  truths:
    - "User can run 'npm run setup' to install all dependencies locally"
    - "System supports both x64 and ARM64 container architectures"
    - "Platform operates entirely locally without external dependencies"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies and scripts"
      contains: "podman"
    - path: "docker-compose.yml"
      provides: "Local container orchestration"
      min_lines: 20
    - path: "scripts/setup.sh"
      provides: "Automated platform setup"
      exports: ["setup", "verify"]
  key_links:
    - from: "package.json"
      to: "scripts/setup.sh"
      via: "npm run setup"
      pattern: "npm.*setup"
    - from: "docker-compose.yml"
      to: "podman"
      via: "podman-compose or podman play kube"
      pattern: "podman.*(compose|play)"
---

<objective>
Establish the foundational project structure and container runtime for secure cybersecurity training platform.

Purpose: Creates the secure, local-only foundation that all subsequent phases will build upon. Ensures platform can operate entirely locally with proper container isolation.
Output: Complete project setup with Podman runtime, local orchestration, and automated installation scripts.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-security/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Create Project Structure</name>
  <files>package.json, README.md, .gitignore</files>
  <action>
    Initialize Node.js project with package.json containing:
    - Name: "cybersec-training-platform"
    - Scripts for setup, start, monitoring, cleanup
    - Dependencies: podman-compose or equivalent for local orchestration
    - DevDependencies: development tools

    Create README.md with:
    - Project description and core value proposition
    - Local-only architecture explanation
    - Quick start instructions (npm run setup, npm start)
    - Architecture overview (Podman + monitoring)

    Create .gitignore excluding:
    - node_modules, .env files
    - Container logs (logs/*)
    - Monitoring data (monitoring/data/*)
    - Temporary container configs (tmp/)
  </action>
  <verify>ls package.json README.md .gitignore && npm run --silent</verify>
  <done>Project has valid package.json with setup scripts, comprehensive README, and proper .gitignore</done>
</task>

<task type="auto">
  <name>Create Container Orchestration</name>
  <files>docker-compose.yml, scripts/setup.sh</files>
  <action>
    Create docker-compose.yml for local orchestration with:
    - Prometheus service (metrics collection)
    - Grafana service (metrics visualization)
    - Volume mounts for persistent configs and data
    - Network isolation between services
    - Environment variables for configuration
    - Multi-architecture support (platform: linux/amd64,linux/arm64)

    Create scripts/setup.sh with executable permissions:
    - Check for Podman installation (install if missing on supported systems)
    - Verify multi-architecture support (QEMU, buildx)
    - Initialize monitoring stack
    - Create necessary directories (logs/, monitoring/data/, security/)
    - Set proper permissions for container operations
    - Verify installation with health checks
  </action>
  <verify>chmod +x scripts/setup.sh && ./scripts/setup.sh --dry-run</verify>
  <done>Setup script successfully verifies Podman installation and multi-arch support, docker-compose.yml defines monitoring stack</done>
</task>

<task type="auto">
  <name>Validate Local-Only Operation</name>
  <files>scripts/verify.sh</files>
  <action>
    Create scripts/verify.sh with executable permissions to validate:
    - No external network dependencies (all services run locally)
    - Container isolation (containers cannot access host filesystem)
    - Multi-architecture container support (ARM64 and x64)
    - Podman rootless operation (no sudo required)
    - Local data persistence (monitoring data survives restarts)

    Script should test:
    - podman version and rootless mode
    - podman-compose or podman play kube functionality
    - Multi-arch manifest creation and usage
    - Local network-only communication between services
    - File permission isolation
  </action>
  <verify>chmod +x scripts/verify.sh && ./scripts/verify.sh</verify>
  <done>Verification script confirms platform operates entirely locally with proper isolation and multi-architecture support</done>
</task>

</tasks>

<verification>
- Run `npm run setup` completes without errors
- Run `npm run verify` passes all checks
- `podman ps` shows no external network connections
- Platform supports both ARM64 and x64 architectures
- All services run as non-root user
</verification>

<success_criteria>
- **CHAL-08**: Platform operates entirely locally - verified by setup and verification scripts
- **INFR-04**: Multi-architecture support - confirmed by QEMU and buildx setup
- Foundation established for secure container isolation and resource management
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-security/01-01-SUMMARY.md`
</output>